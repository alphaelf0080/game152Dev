# Graphics Editor Extension - 安裝與使用指南

## ✅ 構建狀態

擴展已成功構建！所有 TypeScript 文件已編譯為 JavaScript。

## 📁 文件結構

```
graphics-editor/
├── package.json          ✅ 擴展配置
├── tsconfig.json         ✅ TypeScript 配置
├── README.md             ✅ 完整文檔
├── INSTALL.md            ✅ 本文件
├── src/
│   └── main.ts           ✅ 主入口 (源碼)
├── panels/
│   ├── default.html      ✅ 編輯器界面
│   └── default.ts        ✅ 面板腳本 (源碼)
├── dist/                 ✅ 編譯輸出
│   ├── src/
│   │   └── main.js       ✅ 主入口 (編譯後)
│   └── panels/
│       └── default.js    ✅ 面板腳本 (編譯後)
└── static/
    └── icon.svg          ✅ 圖標
```

## 🚀 在 Cocos Creator 中啟用

### 方法 1: 通過擴展管理器

1. 打開 Cocos Creator 3.8
2. 菜單欄：**擴展 > 擴展管理器**
3. 點擊 **項目** 標籤
4. 找到 **graphics-editor**
5. 點擊 **啟用** 按鈕

### 方法 2: 手動刷新

1. 確保擴展文件夾在正確位置：
   ```
   your-project/extensions/graphics-editor/
   ```

2. 在 Cocos Creator 中：
   - 菜單欄：**開發者 > 重新加載擴展**
   - 或按 `Ctrl + Shift + F12`

## 📖 使用方法

### 1. 打開編輯器

菜單欄：**擴展 > Graphics Editor > 打開 Graphics 編輯器**

### 2. 設置畫布與坐標系統 ⭐

#### 載入背景圖片
1. 點擊「**載入背景**」按鈕
2. 選擇參考圖片（支援 PNG、JPG、JPEG、WEBP）
3. 背景圖片會自動縮放到畫布尺寸
4. 可點擊「**清除背景**」移除背景圖片

#### 選擇坐標系統
根據你的需求選擇原點位置：
- **左下 (Cocos 預設)** - 推薦！與 Cocos Creator 預設坐標一致
- **中心 (0,0)** - 適合需要對稱設計的情況
- **左上** - 適合從左上角開始佈局

#### 調整畫布尺寸
1. 在右側「畫布設置」中輸入寬度和高度
2. 點擊「**應用尺寸**」按鈕
3. 畫布會重新調整，背景圖片會重新適配

#### 網格與坐標
- ✅ **顯示網格** - 勾選顯示 50px 間距網格
- 紅色線 = X 軸
- 綠色線 = Y 軸
- 藍色標籤 = 原點 (0, 0)
- 網格上的數字 = 實際 Cocos 坐標值

### 3. 繪製圖形

1. **選擇工具**：矩形、圓形、線條
2. **設置顏色**：填充色、描邊色
3. **調整參數**：線寬 (0-20)、填充/描邊模式
4. **繪製**：在畫布上拖動滑鼠
5. **查看坐標**：滑鼠移動時右下角顯示實時坐標
   - 格式：`Canvas: (x, y) → Cocos: (x, y)`

### 4. 導出代碼

1. 查看右側「生成的腳本代碼」
2. 代碼會自動包含坐標系統註釋
3. 點擊「導出為 TypeScript 腳本」
4. 保存 `CustomGraphics.ts` 文件

```typescript
// 1. 將導出的文件放入 assets/script/

// 2. 在場景中：
//    - 創建節點
//    - 添加 Graphics 組件
//    - 添加 CustomGraphics 組件
//    - 連接 Graphics 引用

// 3. 運行查看效果
```

## 🔧 開發命令

```bash
# 構建擴展
npm run build

# 監聽模式 (自動編譯)
npm run watch
```

## 🎨 功能特性

### 背景圖片與坐標系統 ⭐ NEW
- ✅ **載入背景圖片** - 作為繪圖參考
- ✅ **網格顯示** - 50像素間距的參考網格
- ✅ **坐標系統選擇**：
  - 中心 (0,0) - 畫布中心為原點
  - 左下 (Cocos 預設) - 左下角為原點，Y軸向上
  - 左上 - 左上角為原點，Y軸向下
- ✅ **實時坐標顯示** - 同時顯示 Canvas 坐標和 Cocos 坐標
- ✅ **坐標刻度標註** - 網格上顯示實際 Cocos 坐標值
- ✅ **自定義畫布尺寸** - 100px ~ 2000px

### 繪圖工具
- ✅ 矩形 (Rectangle)
- ✅ 圓形 (Circle)
- ✅ 線條 (Line)
- 🔄 多邊形 (待開發)
- 🔄 圓弧 (待開發)

### 編輯功能
- ✅ 實時預覽
- ✅ 顏色選擇（填充色、描邊色）
- ✅ 線寬調整 (0-20)
- ✅ 填充/描邊模式切換
- ✅ 撤銷 (Ctrl+Z)
- ✅ 清空畫布

### 代碼生成
- ✅ 自動生成 TypeScript 代碼
- ✅ **坐標自動轉換** - Canvas 坐標轉為 Cocos 坐標
- ✅ 實時預覽
- ✅ 一鍵導出
- ✅ 符合 Cocos Creator 3.8 API
- ✅ 包含坐標系統註釋

## 🐛 故障排除

### 擴展未出現在列表中

1. 檢查文件夾位置：
   ```
   project/extensions/graphics-editor/
   ```

2. 確認 `package.json` 存在且格式正確

3. 重新加載擴展：
   - **開發者 > 重新加載擴展**

### 無法打開編輯器面板

1. 檢查控制台是否有錯誤信息
2. 確認 `dist/` 文件夾已生成
3. 重新運行 `npm run build`

### 背景圖片無法載入

1. 確認圖片格式支援（PNG、JPG、JPEG、WEBP）
2. 檢查文件路徑是否包含特殊字符
3. 查看 Cocos Creator 控制台錯誤信息

### 坐標顯示不正確

1. 確認選擇了正確的坐標系統
2. 左下坐標系：Y 軸向上（Cocos 預設）
3. 中心坐標系：原點在畫布中心
4. 左上坐標系：Y 軸向下

### 代碼生成錯誤

1. 確保繪製了至少一個圖形
2. 檢查顏色和線寬設置
3. 查看控制台錯誤信息

## 💡 使用技巧

### 精確對齊背景圖片
1. 載入你的 UI 設計稿作為背景
2. 選擇「左下」坐標系（與 Cocos 一致）
3. 根據設計稿尺寸設置畫布大小
4. 打開網格輔助對齊
5. 按照設計稿繪製圖形

### 坐標系統選擇建議
- **UI 元素**：使用「左下」- 與 Cocos Creator 預設一致
- **對稱圖形**：使用「中心」- 方便計算對稱位置
- **從設計稿轉換**：使用「左下」或「左上」- 根據設計稿原點

### 快速驗證坐標
1. 滑鼠移動到關鍵位置
2. 右下角顯示實時坐標
3. 記錄 Cocos 坐標值
4. 在生成的代碼中驗證

## 📝 快捷鍵

- `Ctrl + Z` - 撤銷上一步操作

## 🔗 相關文檔

- [Cocos Creator Graphics API](https://docs.cocos.com/creator/3.8/manual/zh/ui-system/components/editor/graphics.html)
- [擴展系統文檔](https://docs.cocos.com/creator/3.8/manual/zh/editor/extension/)

## 📧 支持

如有問題，請查看：
1. README.md - 完整功能文檔
2. Cocos Creator 控制台 - 錯誤信息
3. 擴展日誌 - 調試信息

## ✨ 版本信息

- **版本**: 1.0.0
- **Cocos Creator**: >= 3.8.0
- **TypeScript**: 5.8.3
- **構建日期**: 2025-10-27

---

**構建成功！現在可以在 Cocos Creator 中啟用並使用此擴展。** 🎉
