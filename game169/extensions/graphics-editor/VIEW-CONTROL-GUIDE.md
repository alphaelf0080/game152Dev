# Graphics Editor - 視圖控制功能說明

## 🎯 v1.2.0 更新內容

### ✨ 新增功能

#### 1. **背景圖片載入** ✅ 已修復
- 使用瀏覽器原生文件選擇器
- 支援拖放檔案載入
- 自動調整畫布尺寸為圖片尺寸
- 載入後自動適應視窗

#### 2. **縮放功能 (Zoom)**
- **放大** - 按鈕或快捷鍵 `+` / `=`
- **縮小** - 按鈕或快捷鍵 `-` / `_`
- **適應視窗 (Fit)** - 按鈕或快捷鍵 `F`
- **重置 100%** - 按鈕或快捷鍵 `R`
- **滾輪縮放** - 以滑鼠位置為中心縮放
- 縮放範圍: 10% ~ 1000%

#### 3. **平移功能 (Pan)**
- **滑鼠拖動** - 在畫布容器空白處按住滑鼠左鍵拖動
- **中鍵拖動** - 按住滑鼠中鍵拖動
- **游標變化** - 平移時顯示抓取手勢

#### 4. **視圖信息顯示**
- **右上角** - 顯示當前縮放比例和平移位置
- **右下角** - 顯示滑鼠 Canvas 坐標和 Cocos 坐標
- 實時更新

---

## 📖 使用指南

### 基本操作流程

#### 1️⃣ 載入背景圖片
```
點擊「載入背景」→ 選擇圖片 → 自動適應視窗
```

**結果**:
- 畫布尺寸自動設置為圖片尺寸
- 視圖自動縮放到適合視窗大小
- 背景圖片顯示在畫布上

#### 2️⃣ 調整視圖

**放大查看細節**:
```
方法 1: 點擊「放大 (+)」按鈕
方法 2: 按鍵盤 + 或 =
方法 3: 滾輪向上滾動
```

**縮小查看全局**:
```
方法 1: 點擊「縮小 (-)」按鈕
方法 2: 按鍵盤 - 或 _
方法 3: 滾輪向下滾動
```

**適應視窗**:
```
方法 1: 點擊「適應 (F)」按鈕
方法 2: 按鍵盤 F
```

**重置視圖**:
```
方法 1: 點擊「重置 (R)」按鈕
方法 2: 按鍵盤 R
```

#### 3️⃣ 平移視圖

**移動畫布位置**:
```
方法 1: 在畫布容器空白處按住左鍵拖動
方法 2: 按住滑鼠中鍵拖動
```

**提示**: 游標會變成抓取手勢 (grabbing)

#### 4️⃣ 精確繪製

結合縮放和平移功能:
```
1. 載入設計稿背景
2. 按 F 適應視窗
3. 找到要繪製的區域
4. 用滾輪放大該區域
5. 拖動調整位置
6. 開始繪製
7. 完成後按 F 查看整體效果
```

---

## 🎮 快捷鍵一覽

| 功能 | 快捷鍵 | 說明 |
|------|--------|------|
| 放大 | `+` 或 `=` | 以畫布中心放大 |
| 縮小 | `-` 或 `_` | 以畫布中心縮小 |
| 適應視窗 | `F` | 自動縮放到適合視窗 |
| 重置 | `R` | 重置為 100% 並居中 |
| 滾輪縮放 | 滾輪 | 以滑鼠位置為中心縮放 |
| 平移 | 左鍵拖動 | 在空白處拖動 |
| 平移 | 中鍵拖動 | 任意位置拖動 |

---

## 🔧 技術細節

### 座標轉換

繪製時考慮了縮放因子:

```typescript
// 屏幕座標 → Canvas 座標
function screenToCanvas(screenX, screenY) {
    const rect = canvas.getBoundingClientRect();
    return {
        x: (screenX - rect.left) / zoom,
        y: (screenY - rect.top) / zoom
    };
}
```

### 視圖變換

使用 CSS Transform 實現:

```css
transform: translate(panX, panY) scale(zoom);
transform-origin: 0 0;
```

### 縮放中心

**按鈕縮放** - 以畫布中心為縮放中心:
```typescript
adjustPanAfterZoom(oldZoom) {
    const centerX = containerWidth / 2;
    const centerY = containerHeight / 2;
    // 保持畫布中心位置不變
}
```

**滾輪縮放** - 以滑鼠位置為縮放中心:
```typescript
onWheel(e) {
    const mouseX = e.clientX - rect.left;
    const mouseY = e.clientY - rect.top;
    // 保持滑鼠下的點位置不變
}
```

---

## 💡 使用技巧

### 技巧 1: 快速定位細節

```
1. 按 F 適應整體
2. 找到目標區域
3. 將滑鼠移到該區域
4. 滾輪放大（自動以滑鼠為中心）
5. 微調位置後繪製
```

### 技巧 2: 精確對齊

```
1. 放大到 200% 以上
2. 開啟網格顯示
3. 使用網格線對齊
4. 查看實時坐標確認位置
```

### 技巧 3: 檢查整體效果

```
繪製過程中隨時按 F 查看整體
完成後按 R 重置到 100% 確認尺寸
```

### 技巧 4: 處理大圖片

```
1. 載入大尺寸設計稿（如 1920x1080）
2. 自動縮放到適合視窗（如 50%）
3. 用滾輪局部放大到 100% 或更高
4. 精確繪製細節
5. 按 F 快速返回整體視圖
```

---

## 🐛 已解決問題

### ❌ v1.1.0 問題
- 背景圖片無法載入（使用了錯誤的文件 API）
- 無法縮放查看細節
- 無法平移調整位置
- 大尺寸畫布超出視窗

### ✅ v1.2.0 解決方案
- ✅ 改用瀏覽器原生 FileReader API
- ✅ 實現完整的縮放系統（10% ~ 1000%）
- ✅ 實現平移系統（拖動移動）
- ✅ 自動適應視窗功能

---

## 📊 性能優化

### Canvas 層級渲染
- 背景層: 僅在圖片改變時重繪
- 網格層: 僅在設置改變時重繪
- 繪圖層: 繪製時實時更新

### 變換優化
- 使用 CSS Transform 硬件加速
- 平滑過渡效果 (transition: 0.1s)
- 避免過度重繪

---

## 🎬 使用範例

### 範例 1: UI 框架設計

```typescript
// 場景: 設計遊戲 UI 框架
1. 載入 UI 設計稿 (1920x1080)
   → 自動縮放到 50%

2. 按 F 確認整體佈局
   → 視圖自動適應視窗

3. 找到頂部導航欄區域
   → 滾輪放大到 150%

4. 精確繪製導航欄邊框
   → 矩形工具，參考背景圖

5. 按 F 查看整體效果
   → 確認位置正確

6. 移動到其他區域繼續繪製
   → 拖動平移視圖
```

### 範例 2: 角色對話框

```typescript
// 場景: 繪製對話框氣泡
1. 載入角色設計稿 (800x600)
   → 自動適應視窗

2. 將滑鼠移到對話框位置
   → 滾輪放大到 200%

3. 開啟網格，選擇「中心」坐標系
   → 方便對稱繪製

4. 繪製圓角矩形對話框
   → 使用圓形和矩形組合

5. 按 F 查看在角色上的效果
   → 確認大小和位置

6. 導出代碼
   → 坐標自動轉換為 Cocos 坐標
```

---

## 🆚 版本對比

| 功能 | v1.0.0 | v1.1.0 | v1.2.0 ✨ |
|------|--------|--------|----------|
| 背景圖片 | ❌ | ❌ 有問題 | ✅ 已修復 |
| 坐標系統 | ❌ | ✅ | ✅ |
| 網格顯示 | ❌ | ✅ | ✅ |
| 縮放功能 | ❌ | ❌ | ✅ 新增 |
| 平移功能 | ❌ | ❌ | ✅ 新增 |
| 滾輪縮放 | ❌ | ❌ | ✅ 新增 |
| 適應視窗 | ❌ | ❌ | ✅ 新增 |
| 快捷鍵 | ❌ | ❌ | ✅ 新增 |
| 實時坐標 | ❌ | ✅ | ✅ 改進 |

---

## 🚀 下一步計劃 (v1.3.0)

- [ ] 多邊形繪製工具
- [ ] 貝塞爾曲線工具
- [ ] 圖層系統
- [ ] 形狀編輯（移動、旋轉、縮放）
- [ ] 撤銷/重做歷史記錄
- [ ] 背景圖片透明度調整
- [ ] 標尺顯示
- [ ] 吸附對齊功能

---

**版本**: 1.2.0  
**更新日期**: 2025-10-27  
**編譯狀態**: ✅ 成功  
**測試狀態**: ⏳ 待測試
