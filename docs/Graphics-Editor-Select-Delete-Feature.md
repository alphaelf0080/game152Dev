# Graphics Editor - 圖形選取與刪除功能

## 🎯 新功能概述

現在可以選取已繪製的圖形並進行刪除操作！

## 🖱️ 選取圖形

### 方法 1：右鍵點擊
```
在畫布上右鍵點擊圖形 → 圖形被選中並顯示藍色虛線高亮
```

### 方法 2：Ctrl/Cmd + 左鍵
```
按住 Ctrl (Windows) 或 Cmd (Mac) + 左鍵點擊 → 選中圖形
```

### 選中效果
- ✅ 圖形周圍顯示**藍色虛線邊框**
- ✅ 工具欄顯示 **"刪除選中 (Del)"** 按鈕（紅色）
- ✅ 控制台輸出選中信息

## 🗑️ 刪除圖形

### 方法 1：鍵盤快捷鍵
```
選中圖形 → 按 Delete 或 Backspace 鍵 → 圖形被刪除
```

### 方法 2：點擊按鈕
```
選中圖形 → 點擊紅色「刪除選中」按鈕 → 圖形被刪除
```

### 刪除後效果
- ✅ 圖形從畫布消失
- ✅ 命令列表更新
- ✅ 生成的代碼更新
- ✅ 刪除按鈕自動隱藏

## ⌨️ 取消選取

### 方法 1：ESC 鍵
```
選中圖形 → 按 ESC 鍵 → 取消選取
```

### 方法 2：點擊空白區域
```
右鍵點擊畫布空白處 → 取消選取
```

### 方法 3：繪製新圖形
```
選取工具繪製新圖形 → 自動取消之前的選取
```

## 📊 支持的圖形類型

| 圖形類型 | 選取方式 | 說明 |
|---------|---------|------|
| 矩形 | 點擊矩形區域內 | 包含容差 5px |
| 圓形 | 點擊圓形區域內 | 半徑 + 5px 容差 |
| 線條 | 點擊線條附近 | 線寬 + 5px 容差 |
| 折線（開放）| 點擊任何線段附近 | 線寬 + 5px 容差 |
| 折線（閉合）| 點擊多邊形內部或邊緣 | 支持填充區域檢測 |

## 🎨 視覺反饋

### 未選中狀態
```
圖形正常顯示
刪除按鈕隱藏
```

### 選中狀態
```
圖形 + 藍色虛線邊框（#00BFFF）
虛線樣式：[5px 線段, 5px 間隔]
邊框寬度：3px
刪除按鈕顯示（紅色）
```

## 🔧 技術細節

### 選取檢測算法

**矩形檢測：**
```typescript
點擊坐標在矩形邊界內（含 5px 容差）
```

**圓形檢測：**
```typescript
點到圓心的距離 ≤ 半徑 + 5px
```

**線條檢測：**
```typescript
點到線段的最短距離 ≤ 線寬/2 + 5px
```

**閉合折線檢測：**
```typescript
// 如果有填充：使用射線法檢測點是否在多邊形內
// 否則：檢測每條線段
```

### 點到線段距離算法
```typescript
pointToLineDistance(px, py, x1, y1, x2, y2)
1. 計算投影參數 param = dot(AP, AB) / |AB|²
2. 限制 param 在 [0, 1] 範圍內
3. 計算投影點坐標
4. 返回點到投影點的距離
```

### 點在多邊形內檢測（射線法）
```typescript
isPointInPolygon(x, y, points)
從點發出水平射線，計算與多邊形邊的交點數
奇數 → 在內部
偶數 → 在外部
```

## 🎮 使用流程

### 基本流程
```
1. 繪製一些圖形（矩形、圓形、線條、折線）
2. 右鍵點擊某個圖形（或 Ctrl + 左鍵）
3. 圖形顯示藍色虛線邊框
4. 按 Delete 鍵或點擊「刪除選中」按鈕
5. 圖形被刪除，視圖更新
```

### 連續刪除
```
1. 選中圖形 A → Delete
2. 選中圖形 B → Delete
3. 選中圖形 C → Delete
...
```

### 誤選處理
```
1. 不小心選錯圖形
2. 按 ESC 鍵取消選取
3. 重新選取正確的圖形
```

## ⚡ 快捷鍵匯總

| 快捷鍵 | 功能 | 說明 |
|--------|------|------|
| **右鍵點擊** | 選取圖形 | 主要選取方式 |
| **Ctrl + 左鍵** | 選取圖形 | Windows |
| **Cmd + 左鍵** | 選取圖形 | Mac |
| **Delete** | 刪除選中 | 主要刪除方式 |
| **Backspace** | 刪除選中 | 備用刪除方式 |
| **ESC** | 取消選取 | 或完成折線 |

## 🔄 與現有功能的整合

### 折線繪製模式
```
折線繪製時：
- ESC 鍵 → 完成折線（優先級高）
- 選取功能暫時不可用

折線完成後：
- 可以選取和刪除折線
```

### 撤銷功能
```
撤銷（Ctrl + Z）：刪除最後一個圖形
刪除選中：刪除指定的圖形

兩者可配合使用
```

### 清空功能
```
「清空所有繪圖」：刪除所有圖形
「刪除選中」：只刪除當前選中的圖形
```

## 💡 使用技巧

### 技巧 1：精確選取
```
如果圖形重疊，右鍵點擊會選取最上層的圖形
（最後繪製的圖形）
```

### 技巧 2：批量調整
```
想要調整某個圖形：
1. 右鍵選中 → Delete 刪除
2. 重新繪製修改後的版本
```

### 技巧 3：快速清理
```
想要保留某些圖形：
1. 逐個選取不需要的圖形
2. 按 Delete 鍵刪除
3. 比「清空所有」更精確
```

### 技巧 4：驗證刪除
```
刪除後立即檢查：
- 生成的代碼 ← 該圖形的代碼已消失
- 命令列表 ← 對應命令已移除
```

## 🐛 注意事項

### 注意 1：右鍵菜單
```
右鍵在畫布上會選取圖形，不會彈出瀏覽器菜單
這是正常行為
```

### 注意 2：選取容差
```
點擊位置距離圖形邊緣 5px 內都可以選中
如果無法選中，請點擊更靠近圖形中心的位置
```

### 注意 3：折線選取
```
開放的折線：只能點擊線段附近選中
閉合的折線：可以點擊內部區域選中（如果有填充）
```

### 注意 4：線條選取
```
細線條可能不容易選中
建議點擊線條中間位置
```

## 📈 改進建議

### 未來可能添加的功能
- [ ] 框選多個圖形
- [ ] 拖動調整圖形位置
- [ ] Ctrl + A 全選
- [ ] Ctrl + C/V 複製粘貼
- [ ] 圖形順序調整（上移/下移）
- [ ] 圖形屬性編輯面板

## 🎉 總結

### 核心優勢
✅ **直觀操作** - 右鍵點擊選取，符合使用習慣  
✅ **視覺反饋** - 藍色虛線高亮，清楚明確  
✅ **快捷便利** - Delete 鍵快速刪除  
✅ **精確檢測** - 智能判斷點擊位置  
✅ **類型全面** - 支持所有圖形類型  

現在編輯圖形更加靈活方便了！🎨✨
