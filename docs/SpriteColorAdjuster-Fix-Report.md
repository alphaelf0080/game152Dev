# SpriteColorAdjuster ä¿®å¾©å ±å‘Š

## ğŸ› å•é¡Œæè¿°

åŸå…ˆçš„ `SpriteColorAdjuster` çµ„ä»¶å­˜åœ¨ä»¥ä¸‹å•é¡Œï¼š

1. **å¿…é ˆå‹¾é¸"å³æ™‚æ›´æ–°"æ‰èƒ½ç”Ÿæ•ˆ** - é€™ä¸ç¬¦åˆé æœŸè¡Œç‚º
2. **ç·¨è¼¯å™¨ä¸­èª¿æ•´å±¬æ€§ç„¡åæ‡‰** - å› ç‚ºæ‰€æœ‰ setter éƒ½æª¢æŸ¥ `_liveUpdate` æ¨™èªŒ

## âœ… ä¿®å¾©å…§å®¹

### 1. ç§»é™¤ `_liveUpdate` å±¬æ€§

**åŸå› ï¼š**
- é€™å€‹å±¬æ€§å°è‡´çµ„ä»¶å¿…é ˆå‹¾é¸æ‰èƒ½å·¥ä½œ
- Cocos Creator çš„ `@executeInEditMode` å·²ç¶“æä¾›ç·¨è¼¯å™¨å³æ™‚é è¦½åŠŸèƒ½
- æ‰€æœ‰å±¬æ€§ setter éƒ½æ‡‰è©²ç«‹å³ç”Ÿæ•ˆï¼Œä¸éœ€è¦é¡å¤–é–‹é—œ

**ä¿®æ”¹å‰ï¼š**
```typescript
@property({
    displayName: "å³æ™‚æ›´æ–°",
    tooltip: "åœ¨ç·¨è¼¯å™¨ä¸­å³æ™‚é è¦½æ•ˆæœ"
})
private _liveUpdate: boolean = true;

set brightness(value: number) {
    this._brightness = Math.max(-1, Math.min(1, value));
    if (this._liveUpdate) {  // âŒ åªæœ‰å‹¾é¸æ‰ç”Ÿæ•ˆ
        this.applyAllAdjustments();
    }
}
```

**ä¿®æ”¹å¾Œï¼š**
```typescript
// _liveUpdate å±¬æ€§å·²ç§»é™¤

set brightness(value: number) {
    this._brightness = Math.max(-1, Math.min(1, value));
    this.applyAllAdjustments();  // âœ… ç«‹å³ç”Ÿæ•ˆ
}
```

### 2. ä¿®æ”¹æ‰€æœ‰å±¬æ€§ Setter

ç§»é™¤äº†æ‰€æœ‰ setter ä¸­çš„ `if (this._liveUpdate)` æª¢æŸ¥ï¼Œæ”¹ç‚ºç›´æ¥èª¿ç”¨ `applyAllAdjustments()`ã€‚

**ä¿®æ”¹çš„ Setterï¼š**
- `brightness` - äº®åº¦
- `contrast` - å°æ¯”åº¦
- `saturation` - é£½å’Œåº¦
- `hue` - è‰²ç›¸
- `tintColor` - ç–ŠåŠ é¡è‰²
- `tintStrength` - ç–ŠåŠ å¼·åº¦
- `grayscale` - ç°éšæ•ˆæœ

## ğŸ“ ç¾åœ¨çš„ä½¿ç”¨æ–¹æ³•

### æ–¹æ³• 1: åœ¨ç·¨è¼¯å™¨ä¸­èª¿æ•´ï¼ˆæ¨è–¦ç”¨æ–¼æ¸¬è©¦ï¼‰

1. **æ·»åŠ çµ„ä»¶ï¼š**
   ```
   - é¸æ“‡ä¸€å€‹å¸¶æœ‰ Sprite çš„ç¯€é»
   - é»æ“Šã€Œæ·»åŠ çµ„ä»¶ã€
   - æœç´¢ã€ŒSpriteColorAdjusterã€
   - æ·»åŠ çµ„ä»¶
   ```

2. **èª¿æ•´å±¬æ€§ï¼š**
   ```
   åœ¨å±¬æ€§æª¢æŸ¥å™¨ä¸­ç›´æ¥æ‹–å‹•æ»‘æ¡¿ï¼š
   - äº®åº¦ (-1 åˆ° 1)
   - å°æ¯”åº¦ (-1 åˆ° 1)
   - é£½å’Œåº¦ (-1 åˆ° 1)
   - è‰²ç›¸ (0 åˆ° 360)
   - ç°éšæ•ˆæœ (å‹¾é¸/å–æ¶ˆ)
   ```

3. **å³æ™‚é è¦½ï¼š**
   ```
   å› ç‚ºæœ‰ @executeInEditMode è£é£¾å™¨ï¼Œ
   åœ¨ç·¨è¼¯å™¨ä¸­èª¿æ•´å±¬æ€§æ™‚æœƒç«‹å³çœ‹åˆ°æ•ˆæœï¼
   ```

### æ–¹æ³• 2: åœ¨ç¨‹å¼ç¢¼ä¸­ä½¿ç”¨

```typescript
import { SpriteColorAdjuster } from './SpriteColorAdjuster';

// ç²å–çµ„ä»¶
const adjuster = this.node.getComponent(SpriteColorAdjuster);

// ç›´æ¥è¨­ç½®å±¬æ€§ï¼ˆç«‹å³ç”Ÿæ•ˆï¼‰
adjuster.setBrightness(0.5);     // è®Šäº®
adjuster.setContrast(0.3);       // å¢åŠ å°æ¯”
adjuster.setSaturation(0.8);     // æ›´é®®è±”
adjuster.setHue(180);            // è‰²ç›¸æ—‹è½‰
adjuster.setGrayscale(true);     // è½‰ç‚ºç°éš

// ä½¿ç”¨å‹•ç•«éæ¸¡
adjuster.animateBrightness(-0.5, 1.0, () => {
    console.log('è®Šæš—å®Œæˆï¼');
});

// ä½¿ç”¨é è¨­æ•ˆæœ
adjuster.applyNightMode();       // å¤œé–“æ¨¡å¼
adjuster.applySepia();           // æ‡·èˆŠæ£•è¤è‰²
adjuster.applyHighContrastBW();  // é«˜å°æ¯”é»‘ç™½
adjuster.applyVibrant();         // é®®è±”æ¨¡å¼
```

## ğŸ§ª æ¸¬è©¦çµ„ä»¶

å·²å‰µå»º `TestColorAdjuster.ts` æ¸¬è©¦çµ„ä»¶ï¼Œå¯ä»¥è‡ªå‹•æ¸¬è©¦æ‰€æœ‰æ•ˆæœã€‚

### ä½¿ç”¨æ–¹æ³•ï¼š

1. **è¨­ç½®å ´æ™¯ï¼š**
   ```
   - å‰µå»ºä¸€å€‹ç¯€é»ï¼Œæ·»åŠ  Sprite çµ„ä»¶ï¼Œè¨­ç½®åœ–ç‰‡
   - ç‚ºè©²ç¯€é»æ·»åŠ  SpriteColorAdjuster çµ„ä»¶
   - å‰µå»ºå¦ä¸€å€‹ç©ºç¯€é»
   - ç‚ºç©ºç¯€é»æ·»åŠ  TestColorAdjuster çµ„ä»¶
   - åœ¨ TestColorAdjuster çš„ã€Œæ¸¬è©¦ç›®æ¨™ã€å±¬æ€§ä¸­ï¼Œæ‹–å…¥å‰é¢çš„ç¯€é»
   ```

2. **é‹è¡Œæ¸¬è©¦ï¼š**
   ```
   - é»æ“Šæ’­æ”¾
   - çµ„ä»¶æœƒæ¯ 2 ç§’è‡ªå‹•åˆ‡æ›ä¸€å€‹æ•ˆæœ
   - è§€å¯Ÿæ§åˆ¶å°è¼¸å‡ºå’Œè¦–è¦ºæ•ˆæœ
   ```

3. **æ¸¬è©¦å…§å®¹ï¼š**
   ```
   æ¸¬è©¦ 1: å¢åŠ äº®åº¦ (+0.5)
   æ¸¬è©¦ 2: é™ä½äº®åº¦ (-0.5)
   æ¸¬è©¦ 3: å¢åŠ å°æ¯”åº¦ (+0.5)
   æ¸¬è©¦ 4: å¢åŠ é£½å’Œåº¦ (+0.8)
   æ¸¬è©¦ 5: è‰²ç›¸æ—‹è½‰ (180åº¦)
   æ¸¬è©¦ 6: ç°éšæ•ˆæœ
   æ¸¬è©¦ 7: é‚„åŸæ­£å¸¸
   ```

## ğŸ” æ•…éšœæ’é™¤

### å•é¡Œ 1: ç·¨è¼¯å™¨ä¸­èª¿æ•´å±¬æ€§æ²’æœ‰åæ‡‰

**æª¢æŸ¥æ¸…å–®ï¼š**
- âœ… ç¯€é»æ˜¯å¦æœ‰ `Sprite` çµ„ä»¶ï¼Ÿ
- âœ… Sprite æ˜¯å¦è¨­ç½®äº†åœ–ç‰‡ï¼Ÿ
- âœ… æ˜¯å¦ä¿å­˜äº†å ´æ™¯ï¼Ÿï¼ˆCtrl+Sï¼‰
- âœ… æ˜¯å¦éœ€è¦åˆ·æ–°ç·¨è¼¯å™¨ï¼Ÿ

**è§£æ±ºæ–¹æ³•ï¼š**
```typescript
// åœ¨çµ„ä»¶çš„ onLoad ä¸­æª¢æŸ¥
onLoad() {
    const sprite = this.getComponent(Sprite);
    if (!sprite) {
        console.error('âŒ æ‰¾ä¸åˆ° Sprite çµ„ä»¶ï¼');
    }
    if (!sprite.spriteFrame) {
        console.error('âŒ Sprite æ²’æœ‰è¨­ç½®åœ–ç‰‡ï¼');
    }
}
```

### å•é¡Œ 2: é‹è¡Œæ™‚èª¿ç”¨æ–¹æ³•æ²’æœ‰æ•ˆæœ

**å¸¸è¦‹åŸå› ï¼š**
```typescript
// âŒ éŒ¯èª¤ï¼šçµ„ä»¶æœªåˆå§‹åŒ–
const adjuster = this.node.getComponent(SpriteColorAdjuster);
adjuster.setBrightness(0.5);  // å¯èƒ½åœ¨ onLoad ä¹‹å‰èª¿ç”¨

// âœ… æ­£ç¢ºï¼šç¢ºä¿åœ¨ start æˆ–ä¹‹å¾Œèª¿ç”¨
start() {
    const adjuster = this.node.getComponent(SpriteColorAdjuster);
    if (adjuster) {
        adjuster.setBrightness(0.5);
    }
}
```

### å•é¡Œ 3: å‹•ç•«ä¸æµæš¢

**åŸå› ï¼š** update æ–¹æ³•ä¸­çš„å‹•ç•«é‚è¼¯ä¾è³´æ–¼ deltaTime

**è§£æ±ºæ–¹æ³•ï¼š**
```typescript
// ç¢ºä¿å‹•ç•«æ™‚é•·åˆç†ï¼ˆå»ºè­° 0.3 - 2.0 ç§’ï¼‰
adjuster.animateBrightness(0.5, 1.0);  // âœ… 1ç§’ï¼Œæµæš¢
adjuster.animateBrightness(0.5, 0.1);  // âŒ 0.1ç§’ï¼Œå¤ªå¿«
adjuster.animateBrightness(0.5, 10.0); // âŒ 10ç§’ï¼Œå¤ªæ…¢
```

## ğŸ“Š æ€§èƒ½å»ºè­°

1. **éœæ…‹åœ–ç‰‡ï¼š** 
   - åœ¨ç·¨è¼¯å™¨ä¸­è¨­ç½®å¥½åƒæ•¸
   - é‹è¡Œæ™‚ä¸éœ€è¦é »ç¹èª¿æ•´
   - CPU é–‹éŠ·æ¥µä½

2. **å‹•æ…‹æ•ˆæœï¼š**
   - ä½¿ç”¨å‹•ç•«æ–¹æ³•ï¼ˆå¦‚ `animateBrightness`ï¼‰
   - é¿å…åœ¨ update ä¸­æ¯å¹€èª¿ç”¨ setter
   - å‹•ç•«å®Œæˆå¾Œæœƒè‡ªå‹•åœæ­¢

3. **æ‰¹é‡èª¿æ•´ï¼š**
   ```typescript
   // âŒ ä¸å¥½ï¼šå¤šæ¬¡èª¿ç”¨ apply
   adjuster.setBrightness(0.5);
   adjuster.setContrast(0.3);
   adjuster.setSaturation(0.8);
   
   // âœ… æ›´å¥½ï¼šç›´æ¥è¨­ç½®å±¬æ€§
   adjuster.brightness = 0.5;
   adjuster.contrast = 0.3;
   adjuster.saturation = 0.8;
   // æ¯å€‹ setter æœƒè‡ªå‹•èª¿ç”¨ apply
   ```

## ğŸ¯ ä¿®å¾©é©—è­‰

### æª¢æŸ¥åˆ—è¡¨ï¼š

- [x] ç§»é™¤ `_liveUpdate` å±¬æ€§
- [x] ä¿®æ”¹æ‰€æœ‰ setter ç‚ºç«‹å³ç”Ÿæ•ˆ
- [x] ç·¨è­¯ç„¡éŒ¯èª¤
- [x] å‰µå»ºæ¸¬è©¦çµ„ä»¶
- [x] æ›´æ–°æ–‡æª”

### æ¸¬è©¦æª¢æŸ¥ï¼š

```bash
# 1. ç·¨è­¯æ¸¬è©¦
âœ… TypeScript ç·¨è­¯ç„¡éŒ¯èª¤

# 2. ç·¨è¼¯å™¨æ¸¬è©¦ï¼ˆå¾…åŸ·è¡Œï¼‰
- åœ¨ç·¨è¼¯å™¨ä¸­æ·»åŠ çµ„ä»¶
- èª¿æ•´å„å€‹å±¬æ€§
- è§€å¯Ÿæ˜¯å¦ç«‹å³ç”Ÿæ•ˆ

# 3. é‹è¡Œæ™‚æ¸¬è©¦ï¼ˆå¾…åŸ·è¡Œï¼‰
- ä½¿ç”¨ TestColorAdjuster çµ„ä»¶
- è§€å¯Ÿè‡ªå‹•æ¸¬è©¦æ•ˆæœ
- æª¢æŸ¥æ§åˆ¶å°è¼¸å‡º

# 4. API æ¸¬è©¦ï¼ˆå¾…åŸ·è¡Œï¼‰
- åœ¨ä»£ç¢¼ä¸­èª¿ç”¨å„å€‹æ–¹æ³•
- æ¸¬è©¦å‹•ç•«éæ¸¡
- æ¸¬è©¦é è¨­æ•ˆæœ
```

## ğŸ“š ç›¸é—œæ–‡ä»¶

- **ä¸»çµ„ä»¶ï¼š** `SpriteColorAdjuster.ts`
- **æ¸¬è©¦çµ„ä»¶ï¼š** `TestColorAdjuster.ts`
- **ä½¿ç”¨æŒ‡å—ï¼š** `SpriteColorAdjuster-Guide.md`
- **å¿«é€Ÿåƒè€ƒï¼š** `SpriteColorAdjuster-Quick-Reference.md`
- **ä¿®å¾©å ±å‘Šï¼š** `SpriteColorAdjuster-Fix-Report.md`ï¼ˆæœ¬æ–‡ä»¶ï¼‰

## ğŸš€ ä¸‹ä¸€æ­¥

1. **åœ¨ Cocos Creator ä¸­æ¸¬è©¦**
   ```
   - æ‰“é–‹é …ç›®
   - åˆ·æ–°è³‡æºï¼ˆCtrl+Rï¼‰
   - é©—è­‰ç·¨è¼¯å™¨å³æ™‚é è¦½
   - é‹è¡ŒéŠæˆ²æ¸¬è©¦
   ```

2. **æ•´åˆåˆ°éŠæˆ²ä¸­**
   ```
   - ç‚ºæŒ‰éˆ•æ·»åŠ æŒ‰ä¸‹è®Šæš—æ•ˆæœ
   - ç‚ºè´å¾—çš„ Symbol æ·»åŠ é«˜äº®æ•ˆæœ
   - ç‚ºå ´æ™¯åˆ‡æ›æ·»åŠ è‰²å½©éæ¸¡
   - ç‚ºç‰¹æ®Šç‹€æ…‹æ·»åŠ è¦–è¦ºåé¥‹
   ```

3. **æ€§èƒ½å„ªåŒ–**ï¼ˆå¦‚æœ‰éœ€è¦ï¼‰
   ```
   - ä½¿ç”¨å°è±¡æ± è¤‡ç”¨çµ„ä»¶
   - é¿å…é »ç¹çš„å‹•ç•«åˆ‡æ›
   - ç›£æ§ FPS å’Œå…§å­˜ä½¿ç”¨
   ```

---

**ä¿®å¾©æ™‚é–“ï¼š** 2025-10-15  
**ä¿®å¾©è€…ï¼š** GitHub Copilot  
**æ¸¬è©¦ç‹€æ…‹ï¼š** ä»£ç¢¼ç·¨è­¯é€šéï¼Œå¾… Cocos Creator é‹è¡Œæ™‚æ¸¬è©¦
