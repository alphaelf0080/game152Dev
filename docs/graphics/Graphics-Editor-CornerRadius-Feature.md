# Graphics Editor - 圓角化功能說明

## 功能概述

為已選取的矩形添加圓角效果的新功能已實現！

## 使用方法

### 1. 選取矩形
- 在已繪製的矩形上右鍵點擊或 Ctrl 點擊以選取
- 選中後，矩形會顯示虛線邊框

### 2. 設置圓角
- 當選中矩形時，工具欄會出現**「矩形圓角」**區域
- 設置**圓角半徑**值（0-100 像素）
- 預設值為 10 px

### 3. 應用圓角
- 點擊**「應用圓角」**按鈕
- 矩形的四個角會立即變成圓角
- 如果矩形已經有圓角，會被新的值覆蓋

## 技術細節

### 新增屬性
- `shape.radius` - 矩形的圓角半徑值（可選）

### 新增方法
- `applyCornerRadius()` - 為選中的矩形應用圓角
- `drawRoundedRect()` - 使用 Canvas API 繪製圓角矩形

### 繪製原理
使用 Canvas 2D API 的 `arc()` 方法繪製四個 90° 的圓弧，配合 `lineTo()` 方法連接矩形邊框：

```typescript
// 四角圓弧
this.drawCtx.arc(x + width - r, y + r, r, -Math.PI / 2, 0, false);           // 右上
this.drawCtx.arc(x + width - r, y + height - r, r, 0, Math.PI / 2, false);   // 右下
this.drawCtx.arc(x + r, y + height - r, r, Math.PI / 2, Math.PI, false);     // 左下
this.drawCtx.arc(x + r, y + r, r, Math.PI, -Math.PI / 2, false);             // 左上
```

## 支持的功能

✅ 為現有矩形添加圓角  
✅ 修改已有圓角的半徑值  
✅ 支持負寬度/高度（反向拖動）  
✅ 圓角矩形包含在代碼預覽和導出中  
✅ 撤銷/重做支持  

## UI 元素

### 圓角化面板
位置：工具欄 - 操作按鈕區域上方

- **圓角:** 輸入框，範圍 0-100 px
- **應用圓角:** 按鈕，點擊應用設定的圓角值

_當未選中矩形時，該面板隱藏_

## 用例

### 場景 1: 創建圓角矩形按鈕
1. 繪製矩形
2. 右鍵選中
3. 設置圓角值 (如 15 px)
4. 點擊「應用圓角」
5. 導出代碼使用

### 場景 2: 修改圓角
1. 右鍵選中已有圓角的矩形
2. 修改圓角值
3. 點擊「應用圓角」
4. 圓角會更新

## 與標準矩形的區別

| 項目 | 普通矩形 | 圓角矩形 |
|------|--------|--------|
| 角 | 直角 | 圓弧角 |
| radius 屬性 | 無（undefined） | 有（> 0） |
| 繪製方法 | fillRect/strokeRect | drawRoundedRect |
| 適用場景 | 幾何、邊界框 | UI 元素、按鈕、卡片 |

## 注意事項

1. **只適用於矩形** - 圓角功能只能應用於矩形工具繪製的圖形
2. **最小圓角限制** - 圓角半徑不能超過矩形尺寸的一半（自動調整）
3. **影響導出代碼** - 圓角矩形會在代碼預覽中顯示對應的圖形繪製命令

## 導出與編程

圓角矩形在代碼生成中會包含在命令列表中，使您可以：
- 查看圖形繪製命令
- 複製代碼用於其他項目
- 使用導出功能生成 TypeScript 腳本

---

## 下一步

重新啟動 Cocos Creator，在擴展管理器中重新載入 Graphics Editor 擴展，即可使用新功能！

🎉 **現在您可以輕鬆為矩形添加圓角效果了！**
