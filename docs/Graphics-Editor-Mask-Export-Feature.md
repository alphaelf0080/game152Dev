# Graphics Editor - Mask å°å‡ºåŠŸèƒ½

## ğŸ‰ v1.1.0 æ–°åŠŸèƒ½

Graphics Editor ç¾åœ¨æ”¯æŒä¸€éµå°å‡ºå°ˆé–€ç”¨æ–¼ Maskï¼ˆé®ç½©ï¼‰çš„ TypeScript è…³æœ¬ï¼

## âœ¨ æ–°å¢åŠŸèƒ½

### å°å‡ºç‚º Mask è…³æœ¬æŒ‰éˆ•

åœ¨ Graphics Editor çš„å³å´é¢æ¿æ–°å¢äº† **"å°å‡ºç‚º Mask è…³æœ¬"** æŒ‰éˆ•ï¼ˆç´«è‰²ï¼‰ï¼Œé»æ“Šå¾Œæœƒç”Ÿæˆå°ˆé–€å„ªåŒ–ç”¨æ–¼ Cocos Creator Mask çµ„ä»¶çš„ä»£ç¢¼ã€‚

### èˆ‡æ™®é€šå°å‡ºçš„å€åˆ¥

| åŠŸèƒ½ | å°å‡ºç‚º TypeScript è…³æœ¬ | å°å‡ºç‚º Mask è…³æœ¬ |
|------|----------------------|-----------------|
| **ç”¨é€”** | é€šç”¨åœ–å½¢ç¹ªè£½ | Maskï¼ˆé®ç½©ï¼‰å°ˆç”¨ |
| **é¡è‰²** | ä¿ç•™åŸå§‹é¡è‰²å’Œé€æ˜åº¦ | è‡ªå‹•è½‰ç‚ºç™½è‰² (255,255,255,255) |
| **æé‚Š** | åŒ…å«æé‚Šä»£ç¢¼ | ç§»é™¤æé‚Šï¼Œåªä¿ç•™å¡«å…… |
| **çµ„ä»¶** | Graphics | Graphics + Mask |
| **æŠ˜ç·šè™•ç†** | æŒ‰åŸæ¨£å°å‡º | è‡ªå‹•æ·»åŠ  close() é–‰åˆè·¯å¾‘ |
| **é™¤éŒ¯æ¨¡å¼** | ç„¡ | å…§å»ºé™¤éŒ¯æ¨¡å¼ï¼ˆç´…è‰²åŠé€æ˜ï¼‰ |

## ğŸ“¦ å°å‡ºçš„ä»£ç¢¼ç‰¹é»

### 1. è‡ªå‹•å„ªåŒ–é¡è‰²

**æ™®é€šå°å‡ºï¼š**
```typescript
g.fillColor = new Color(255, 0, 0, 255);  // ä¿ç•™åŸå§‹ç´…è‰²
g.strokeColor = new Color(0, 0, 0, 255);  // é»‘è‰²æé‚Š
```

**Mask å°å‡ºï¼š**
```typescript
// Mask å¿…é ˆä½¿ç”¨ç™½è‰²ï¼ˆé™¤éŒ¯æ¨¡å¼é™¤å¤–ï¼‰
if (this.debugMode) {
    g.fillColor.set(255, 0, 0, 128);  // é™¤éŒ¯ï¼šç´…è‰²åŠé€æ˜
} else {
    g.fillColor.set(255, 255, 255, 255);  // æ­£å¸¸ï¼šç™½è‰²
}
```

### 2. ç§»é™¤ä¸å¿…è¦çš„æé‚Š

**æ™®é€šå°å‡ºï¼š**
```typescript
g.rect(-360, 540, 720, -1080);
g.fill();
g.stroke();  // åŒ…å«æé‚Š
```

**Mask å°å‡ºï¼š**
```typescript
g.rect(-360, 540, 720, -1080);
g.fill();  // åªéœ€å¡«å……ï¼Œç„¡æé‚Š
```

### 3. è‡ªå‹•è™•ç†æŠ˜ç·šé–‰åˆ

**æ™®é€šå°å‡ºï¼š**
```typescript
g.moveTo(-163, 123);
g.lineTo(218, 123);
g.lineTo(218, -384);
// å¯èƒ½æœªé–‰åˆ
g.fill();
```

**Mask å°å‡ºï¼š**
```typescript
g.moveTo(-163, 123);
g.lineTo(218, 123);
g.lineTo(218, -384);
g.close(); // è‡ªå‹•é–‰åˆè·¯å¾‘
g.fill();
```

### 4. æ™ºèƒ½è­¦å‘Šç³»çµ±

Mask å°å‡ºæœƒè‡ªå‹•æª¢æ¸¬ä¸¦æ·»åŠ è­¦å‘Šè¨»é‡‹ï¼š

```typescript
// âš ï¸ æ³¨æ„ï¼šå–®ä¸€ç·šæ¢ç„¡æ³•å½¢æˆé®ç½©å€åŸŸ
g.moveTo(0, 0);
g.lineTo(100, 100);

// âš ï¸ è­¦å‘Šï¼šæœªé–‰åˆçš„æŠ˜ç·šç„¡æ³•å½¢æˆé®ç½©å€åŸŸ
// g.close(); // å–æ¶ˆè¨»é‡‹ä»¥é–‰åˆè·¯å¾‘
```

## ğŸ¯ ä½¿ç”¨æµç¨‹

### Step 1: åœ¨ Graphics Editor ä¸­ç¹ªè£½

1. é–‹å•Ÿï¼š**æ“´å±• â†’ Graphics Editor**
2. ç¹ªè£½é®ç½©å½¢ç‹€ï¼ˆçŸ©å½¢/åœ“å½¢/æŠ˜ç·šï¼‰
3. é»æ“Šï¼š**å°å‡ºç‚º Mask è…³æœ¬**ï¼ˆç´«è‰²æŒ‰éˆ•ï¼‰
4. é¸æ“‡ä¿å­˜ä½ç½®ï¼Œé»˜èªæª”åï¼š`CustomMask.ts`

### Step 2: å‰µå»º Mask ç¯€é»

```
MaskNode
  â”œâ”€ UITransform
  â”œâ”€ Graphics
  â”œâ”€ Mask (Type: GRAPHICS_STENCIL)
  â””â”€ CustomMask.ts (å°å‡ºçš„è…³æœ¬)
```

### Step 3: é…ç½®çµ„ä»¶

1. **Mask çµ„ä»¶ï¼š**
   - Type: `GRAPHICS_STENCIL`
   - Inverted: `false`
   
2. **è…³æœ¬å±¬æ€§ï¼š**
   - Graphics: æ‹–å…¥ Graphics çµ„ä»¶
   - Mask: æ‹–å…¥ Mask çµ„ä»¶
   - Debug Mode: é™¤éŒ¯æ™‚å‹¾é¸ï¼ˆé¡¯ç¤ºç´…è‰²åŠé€æ˜ï¼‰

### Step 4: æ·»åŠ è¢«é®ç½©å…§å®¹

åœ¨ MaskNode ä¸‹å‰µå»ºå­ç¯€é»ï¼Œæ·»åŠ  Spriteã€Label ç­‰çµ„ä»¶ã€‚

## ğŸ”§ å°å‡ºçš„å®Œæ•´ä»£ç¢¼çµæ§‹

```typescript
import { _decorator, Component, Graphics, Mask } from 'cc';
const { ccclass, property } = _decorator;

/**
 * Graphics Editor ç”Ÿæˆçš„ Maskï¼ˆé®ç½©ï¼‰ä»£ç¢¼
 * åæ¨™ç³»çµ±: ä¸­å¿ƒ (0,0)
 * 
 * ä½¿ç”¨èªªæ˜ï¼š
 * 1. å°‡æ­¤è…³æœ¬æ›è¼‰åˆ°ç¯€é»ä¸Š
 * 2. æ·»åŠ  Graphics çµ„ä»¶
 * 3. æ·»åŠ  Mask çµ„ä»¶ï¼ˆType: GRAPHICS_STENCILï¼‰
 * 4. åœ¨ Mask ç¯€é»ä¸‹æ·»åŠ å­ç¯€é»ä½œç‚ºè¢«é®ç½©çš„å…§å®¹
 */
@ccclass('CustomMask')
export class CustomMask extends Component {
    
    @property(Graphics)
    graphics: Graphics | null = null;
    
    @property(Mask)
    mask: Mask | null = null;
    
    @property({
        displayName: 'é¡¯ç¤ºé®ç½©å€åŸŸï¼ˆé™¤éŒ¯ï¼‰',
        tooltip: 'å‹¾é¸å¾Œæœƒç”¨åŠé€æ˜ç´…è‰²é¡¯ç¤ºé®ç½©å½¢ç‹€ï¼Œæ–¹ä¾¿èª¿è©¦'
    })
    debugMode: boolean = false;
    
    start() {
        // è‡ªå‹•ç²å–çµ„ä»¶
        if (!this.graphics) {
            this.graphics = this.getComponent(Graphics);
        }
        
        if (!this.mask) {
            this.mask = this.getComponent(Mask);
        }
        
        // ç¹ªè£½é®ç½©
        this.drawMaskShape();
    }
    
    drawMaskShape() {
        const g = this.graphics;
        if (!g) {
            console.error('[CustomMask] Graphics çµ„ä»¶æœªæ‰¾åˆ°ï¼');
            return;
        }
        
        g.clear();
        
        // Mask å¿…é ˆä½¿ç”¨ç™½è‰²ï¼ˆé™¤éŒ¯æ¨¡å¼é™¤å¤–ï¼‰
        if (this.debugMode) {
            g.fillColor.set(255, 0, 0, 128);  // é™¤éŒ¯æ¨¡å¼
        } else {
            g.fillColor.set(255, 255, 255, 255);  // æ­£å¸¸æ¨¡å¼
        }
        
        // === é€™è£¡æ˜¯å¾ Graphics Editor ç”Ÿæˆçš„é®ç½©å½¢ç‹€ ===
        // é®ç½©å½¢ç‹€ 1: çŸ©å½¢
        g.rect(-360, 540, 720, -1080);
        g.fill();
        // === ç”Ÿæˆä»£ç¢¼çµæŸ ===
    }
}
```

## ğŸ¨ å¯¦éš›æ‡‰ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šè€è™æ©Ÿæ²è»¸é®ç½©

```typescript
// åœ¨ Graphics Editor ä¸­ç¹ªè£½ 720x1080 çš„çŸ©å½¢
// é»æ“Šã€Œå°å‡ºç‚º Mask è…³æœ¬ã€
// ç”Ÿæˆçš„ä»£ç¢¼ï¼š

drawMaskShape() {
    const g = this.graphics;
    g.clear();
    g.fillColor.set(255, 255, 255, 255);
    
    // é®ç½©å½¢ç‹€ 1: çŸ©å½¢
    g.rect(-360, 540, 720, -1080);
    g.fill();
}
```

### ç¤ºä¾‹ 2ï¼šåœ“å½¢é ­åƒé®ç½©

```typescript
// åœ¨ Graphics Editor ä¸­ç¹ªè£½åœ“å½¢
// é»æ“Šã€Œå°å‡ºç‚º Mask è…³æœ¬ã€
// ç”Ÿæˆçš„ä»£ç¢¼ï¼š

drawMaskShape() {
    const g = this.graphics;
    g.clear();
    g.fillColor.set(255, 255, 255, 255);
    
    // é®ç½©å½¢ç‹€ 1: åœ“å½¢
    g.circle(0, 0, 100);
    g.fill();
}
```

### ç¤ºä¾‹ 3ï¼šè‡ªå®šç¾©å½¢ç‹€é®ç½©

```typescript
// åœ¨ Graphics Editor ä¸­ä½¿ç”¨æŠ˜ç·šå·¥å…·ç¹ªè£½
// è¨˜å¾—é»æ“Šã€Œå®ŒæˆæŠ˜ç·šã€æˆ–æŒ‰ ESC éµé–‰åˆ
// é»æ“Šã€Œå°å‡ºç‚º Mask è…³æœ¬ã€
// ç”Ÿæˆçš„ä»£ç¢¼ï¼š

drawMaskShape() {
    const g = this.graphics;
    g.clear();
    g.fillColor.set(255, 255, 255, 255);
    
    // é®ç½©å½¢ç‹€ 1: æŠ˜ç·š
    g.moveTo(-163, 123);
    g.lineTo(218, 123);
    g.lineTo(218, -384);
    g.lineTo(-163, -384);
    g.close(); // è‡ªå‹•é–‰åˆè·¯å¾‘
    g.fill();
}
```

## ğŸ› é™¤éŒ¯æŠ€å·§

### ä½¿ç”¨å…§å»ºé™¤éŒ¯æ¨¡å¼

å°å‡ºçš„ä»£ç¢¼è‡ªå¸¶é™¤éŒ¯æ¨¡å¼ï¼Œåªéœ€åœ¨ Inspector ä¸­å‹¾é¸ `debugMode`ï¼š

```typescript
// debugMode = true æ™‚
g.fillColor.set(255, 0, 0, 128);  // ç´…è‰²åŠé€æ˜ï¼Œå¯ä»¥çœ‹åˆ°é®ç½©å€åŸŸ

// debugMode = false æ™‚
g.fillColor.set(255, 255, 255, 255);  // ç™½è‰²ä¸é€æ˜ï¼Œæ­£å¸¸é®ç½©
```

é€™æ¨£å¯ä»¥è¼•é¬†æª¢æŸ¥é®ç½©å½¢ç‹€æ˜¯å¦æ­£ç¢ºï¼

## âš¡ æ€§èƒ½å„ªåŒ–

å°å‡ºçš„ Mask ä»£ç¢¼å·²ç¶“éå„ªåŒ–ï¼š

- âœ… åªåœ¨ `start()` ä¸­ç¹ªè£½ä¸€æ¬¡
- âœ… ç„¡ä¸å¿…è¦çš„æé‚Šè¨ˆç®—
- âœ… æœ€å°åŒ–é¡è‰²è¨­ç½®
- âœ… è‡ªå‹•éŒ¯èª¤æª¢æ¸¬

## ğŸ“Š æŒ‰éˆ•å°æ¯”

| æŒ‰éˆ• | é¡è‰² | ç”¨é€” | å°å‡ºæª”å |
|------|------|------|---------|
| **è¤‡è£½ä»£ç¢¼** | ç¶ è‰² | è¤‡è£½åˆ°å‰ªè²¼æ¿ | - |
| **å°å‡ºç‚º TypeScript è…³æœ¬** | è—è‰² | é€šç”¨åœ–å½¢ç¹ªè£½ | CustomGraphics.ts |
| **å°å‡ºç‚º Mask è…³æœ¬** | ç´«è‰² | Mask é®ç½©å°ˆç”¨ | CustomMask.ts |
| **æ¸…ç©ºæ‰€æœ‰ç¹ªåœ–** | ç´…è‰² | æ¸…é™¤ç•«å¸ƒ | - |

## ğŸ‰ ç¸½çµ

**å°å‡ºç‚º Mask è…³æœ¬**åŠŸèƒ½è®“å‰µå»ºé®ç½©è®Šå¾—æ›´ç°¡å–®ï¼š

1. âœ… ç„¡éœ€æ‰‹å‹•ä¿®æ”¹é¡è‰²ç‚ºç™½è‰²
2. âœ… ç„¡éœ€åˆªé™¤æé‚Šä»£ç¢¼
3. âœ… è‡ªå‹•è™•ç†æŠ˜ç·šé–‰åˆ
4. âœ… å…§å»ºé™¤éŒ¯æ¨¡å¼
5. âœ… æ™ºèƒ½è­¦å‘Šæç¤º
6. âœ… é–‹ç®±å³ç”¨

ç¾åœ¨ä½ å¯ä»¥åœ¨ Graphics Editor ä¸­è¨­è¨ˆä»»æ„è¤‡é›œçš„é®ç½©å½¢ç‹€ï¼Œä¸€éµå°å‡ºï¼Œç«‹å³ä½¿ç”¨ï¼ğŸ¨âœ¨
